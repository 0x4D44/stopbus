# Code Coverage Assessment: Stop the Bus
**Date:** 2026.01.04
**Scope:** `crates/stopbus-core` and `crates/stopbus-ui`

## Executive Summary
The core game logic resides in `stopbus-core`, while `stopbus-ui` handles the Win32 interface.
- **Overall Logic Coverage:** Estimated < 20%
- **Critical Gaps:** The entire game loop, state transitions, human interaction methods, and AI decision-making are largely untested.
- **Passing Tests:** 5 (covering only static helper functions for card values and basic dealing).

## Detailed Analysis

### 1. `stopbus-core` (Logic)
**Source File:** `src/lib.rs` (~580 lines)
**Test File:** `src/lib.rs` (embedded `tests` module)

| Component | Status | Notes |
| :--- | :--- | :--- |
| **Static Helpers** | **High** | `card_rank`, `card_suit`, `card_points`, `hand_max_score` are well tested. |
| **GameState Lifecycle** | **Low** | `new` and `deal_round` are touched, but `start_game` and `start_new_round` are not verified for state reset correctness. |
| **Human Interaction** | **Zero** | `human_stick`, `human_swap_with_stack`, `human_draw_next_card` have no tests. |
| **AI Logic** | **Zero** | `execute_auto_turn`, `try_swap_for_improvement` are completely untested. |
| **Game Loop** | **Zero** | `drive_round_step` (the main state machine) is untested. |
| **Round Finishing** | **Zero** | `finish_round`, `detect_stop_bus`, life deduction, and winner declaration are untested. |

### 2. `stopbus-ui` (Interface)
**Source File:** `src/main.rs`
- Currently contains 0 tests.
- Contains Win32 boilerplate.
- **Action:** Assess if logic can be extracted. For now, excluded from strict unit test coverage goals unless view-logic is separated.

## Conclusion
The current test suite is a skeleton. It validates that the basic "physics" of the cards work (suits, ranks, scoring), but it does **not** validate that the *game* works. The improvement plan will focus on "gamifying" the tests.
