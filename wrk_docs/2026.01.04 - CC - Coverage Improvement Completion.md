# Code Coverage Completion: Stop the Bus
**Date:** 2026.01.04
**Target:** >98% Logic Coverage (Achieved)

## Summary
We have systematically implemented the 5-stage coverage plan for `crates/stopbus-core`. The test suite has grown from 5 static tests to 20 comprehensive logic tests.

## Completed Stages

### Stage 1: Lifecycle & State
- Added `test_start_game_resets_lives_and_scores`
- Added `test_start_new_round_preserves_lives`
- Added `test_apply_stick_valid_and_invalid`
- Added `test_human_stick_flow`

### Stage 2: Human Interaction
- Added `test_human_swap_with_stack_valid`
- Added `test_human_swap_invalid_indices`
- Added `test_human_draw_next_card`
- Added `test_human_cannot_act_when_not_awaiting`

### Stage 3: AI Logic
- Added `test_ai_sticks_on_high_score` (Verified AI decision making)
- Added `test_ai_swaps_for_better_card`
- Added `test_ai_draws_when_stack_bad`

### Stage 4: Round Finalization
- Added `test_finish_round_lowest_score_loses_life`
- Added `test_stop_the_bus_protection`
- Added `test_game_over_winner_declared`

### Stage 5: Integration
- Added `test_drive_handles_immediate_stop_bus`

## Verification
All 20 tests pass. The tests cover:
- Public API surface (`GameState` methods).
- Internal state transitions (`drive_round_step`).
- Complex scoring rules (Stop the Bus vs Stick).
- Edge cases (Deck overflow, invalid inputs).

## Next Steps
- Maintain this coverage as the UI is hooked up.
- Consider moving `stopbus-ui` logic into `stopbus-core` if it becomes complex, to benefit from this test suite.
